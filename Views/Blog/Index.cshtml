@using ComputerDeviceShopping.Models;

@{
    ViewData["Title"] = "Index";
    var articles = ViewData["Articles"] as List<Article>;
    var accountPost = ViewData["AccountPost"] as List<Account>;
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="breadcrumbs_area">
    <div class="container">
        <div class="row">
            <div class="col-12">
                <div class="breadcrumb_content">
                    <ul>
                        <li><a href="@Url.Action("Index","Home")">Trang chủ</a></li>
                        <li>Bài viết</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="blog_details mt-60">
    <div class="container">
        <div class="row">
            <div class="col-lg-9">
                <div class="blog_wrapper">
                    <div class="section-title">
                        <h2>Bài viết</h2>
                    </div>
                    <div class="row">
                        @foreach(var item in articles)
                        {
                            <div class="col-lg-6 col-md-6">
                                <article class="single_blog mb-60">
                                    <figure>
                                        <div class="blog_thumb">
                                            <a href="blog-details.html"><img class="imgBlog" style="height:270px; " src="@item.Avatar" alt=""></a>
                                        </div>
                                        <figcaption class="blog_content">
                                            <h3><a href="@Url.Action("Detail","Blog",new{id = item.ArticleId})">@item.ArticleName</a></h3>
                                            <div class="blog_meta">
                                                @foreach (var acc in accountPost)
                                                {
                                                    if (acc.UserId.Equals(item.UserId))
                                                    {
                                                        <span class="author">Người đăng : <a href="#"></a>@acc.LastName @acc.FirstName /  </span>
                                                    }
                                                }
                                                <span class="post_date">Ngày đăng : <a href="#">@item.CreateAt</a></span>
                                            </div>
                                            <div class="blog_desc">
                                                <p style="text-align: justify;">@(item.SummaryContent.Substring(0,170) + "...")</p>
                                            </div>
                                            <footer class="readmore_button">
                                                <a href='@Url.Action("Detail","Blog",new{id = item.ArticleId})'>Xem thêm</a>
                                            </footer>
                                        </figcaption>
                                    </figure>
                                </article>
                            </div>
                        }
                    </div>
                </div>
            </div>
            @await Component.InvokeAsync("SidebarBlog")
        </div>
    </div>
</div>
<div class="blog_pagination">
    <div class="container">
        <div class="row">
            <div class="col-12">
                <div class="pagination">
                    @{
                        int prevPage = ViewBag.Page - 1;
                        if (prevPage <= 0)
                        {
                            prevPage = 1;
                        }
                        int nextPage = ViewBag.Page + 1;
                        if (nextPage > ViewBag.NoOfPages)
                        {
                            nextPage = ViewBag.NoOfPages;
                        }
                    }
                    @if (articles.Count > 0)
                    {
                        <ul>
                            <li class=""><a class="" href="@Url.Action("Index","Blog",new {page=prevPage})">&laquo;</a></li>
                            @for (int i = ViewBag.DisplayPage; i < ViewBag.NoOfPages; i++)
                            {
                                if (i + 1 == ViewBag.Page)
                                {
                                    <li class="current"><a href="@Url.Action("Index","Blog",new {page = i+1 })" class="">@(i + 1)</a></li>
                                }
                                else
                                {
                                    <li class=""><a href="@Url.Action("Index","Blog",new {page = i+1 })">@(i + 1)</a></li>
                                }
                            }
                            <li class="next"><a class="" href="@Url.Action("Index","Blog",new {page=nextPage})">&raquo;</a></li>
                        </ul>
                    }
                    else
                    {
                        <h1 class="text-center">Sản phẩm này hiện tại không có</h1>
                    }
                </div>
            </div>
        </div>
    </div>
</div>
